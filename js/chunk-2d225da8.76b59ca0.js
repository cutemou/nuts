(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d225da8"],{e5bd:function(t,e,o){"use strict";o.r(e);var n=o("7a23"),c={class:"text-end"},i={class:"table mt-4"},a=Object(n["i"])("thead",null,[Object(n["i"])("tr",null,[Object(n["i"])("th",{width:"120"},"名稱"),Object(n["i"])("th",{width:"120"},"優惠碼"),Object(n["i"])("th",{width:"120"},"折扣百分比"),Object(n["i"])("th",{width:"120"},"到期日"),Object(n["i"])("th",{width:"120"},"是否啟用"),Object(n["i"])("th",{width:"200"},"編輯")])],-1),l={class:"text-right"},s={key:0,class:"text-success"},u={key:1,class:"text-muted"},d={class:"btn-group"};function p(t,e,o,p,b,r){var h=Object(n["B"])("Loading"),m=Object(n["B"])("CouponModal"),j=Object(n["B"])("DelModal");return Object(n["u"])(),Object(n["e"])("div",null,[Object(n["i"])(h,{active:b.isLoading},null,8,["active"]),Object(n["i"])("div",c,[Object(n["i"])("button",{class:"btn btn-success mt-4",type:"button",onClick:e[1]||(e[1]=function(t){return r.openModal(!0)})},"新增優惠卷")]),Object(n["i"])("table",i,[a,Object(n["i"])("tbody",null,[(Object(n["u"])(!0),Object(n["e"])(n["a"],null,Object(n["z"])(b.coupons,(function(e){return Object(n["u"])(),Object(n["e"])("tr",{key:e.id},[Object(n["i"])("td",null,Object(n["E"])(e.title),1),Object(n["i"])("td",null,Object(n["E"])(e.code),1),Object(n["i"])("td",null,Object(n["E"])(e.percent)+"%",1),Object(n["i"])("td",l,Object(n["E"])(t.$filters.date(e.due_date)),1),Object(n["i"])("td",null,[e.is_enabled?(Object(n["u"])(),Object(n["e"])("span",s,"啟用")):(Object(n["u"])(),Object(n["e"])("span",u,"未啟用"))]),Object(n["i"])("td",null,[Object(n["i"])("div",d,[Object(n["i"])("button",{class:"btn btn-outline-primary btn-sm",onClick:function(t){return r.openModal(!1,e)}},"編輯",8,["onClick"]),Object(n["i"])("button",{class:"btn btn-outline-danger btn-sm",onClick:function(t){return r.openDelCouponModal(e)}},"刪除",8,["onClick"])])])])})),128))])]),Object(n["i"])(m,{ref:"couponModal",coupon:b.tempCoupon,onUpdateCoupon:r.updateCoupon},null,8,["coupon","onUpdateCoupon"]),Object(n["i"])(j,{coupon:b.tempCoupon,ref:"delModal",onDeleteSomething:r.delCoupon},null,8,["coupon","onDeleteSomething"])])}var b=o("5530"),r=(o("99af"),{class:"modal",tabindex:"-1",ref:"CouponModal"}),h={class:"modal-dialog"},m={class:"modal-content"},j=Object(n["i"])("div",{class:"modal-header bg-success"},[Object(n["i"])("h5",{class:"modal-title text-white"},"新增優惠卷"),Object(n["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O={class:"modal-body"},f={class:"row gx-2"},C={class:"mb-3 col-md-6"},v=Object(n["i"])("label",{for:"title",class:"form-label"},"名稱",-1),g={class:"mb-3 col-md-6"},M=Object(n["i"])("label",{for:"code",class:"form-label"},"優惠碼",-1),w={class:"mb-3"},x=Object(n["i"])("label",{for:"percent",class:"form-label"},"折扣百分比",-1),k={class:"mb-3"},y=Object(n["i"])("label",{for:"due_date",class:"form-label"},"到期日",-1),_={class:"mb-3"},$={class:"form-check"},D=Object(n["i"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),U={class:"modal-footer"},L=Object(n["i"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function N(t,e,o,c,i,a){var l=this;return Object(n["u"])(),Object(n["e"])("div",r,[Object(n["i"])("div",h,[Object(n["i"])("div",m,[j,Object(n["i"])("div",O,[Object(n["i"])("div",f,[Object(n["i"])("div",C,[v,Object(n["N"])(Object(n["i"])("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入名稱","onUpdate:modelValue":e[1]||(e[1]=function(t){return i.tempCoupon.title=t})},null,512),[[n["I"],i.tempCoupon.title]])]),Object(n["i"])("div",g,[M,Object(n["N"])(Object(n["i"])("input",{type:"text",class:"form-control",id:"code",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[2]||(e[2]=function(t){return i.tempCoupon.code=t})},null,512),[[n["I"],i.tempCoupon.code]])])]),Object(n["i"])("div",w,[x,Object(n["N"])(Object(n["i"])("input",{type:"number",class:"form-control",id:"percent",placeholder:"請輸入折扣百分比(%)","onUpdate:modelValue":e[3]||(e[3]=function(t){return i.tempCoupon.percent=t})},null,512),[[n["I"],i.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["i"])("div",k,[y,Object(n["N"])(Object(n["i"])("input",{type:"text",class:"form-control",id:"due_date",placeholder:"請輸入到期日 ex:2012/04/12","onUpdate:modelValue":e[4]||(e[4]=function(t){return i.tempCoupon.due_date=t})},null,512),[[n["I"],i.tempCoupon.due_date]])]),Object(n["i"])("div",_,[Object(n["i"])("div",$,[Object(n["N"])(Object(n["i"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":e[5]||(e[5]=function(t){return i.tempCoupon.is_enabled=t})},null,512),[[n["H"],i.tempCoupon.is_enabled]]),D])])]),Object(n["i"])("div",U,[L,Object(n["i"])("button",{type:"button",class:"btn btn-success",onClick:e[6]||(e[6]=function(e){return t.$emit("updateCoupon",l.tempCoupon)})},"確認新增")])])])],512)}var T=o("7c2b"),V=o.n(T),E={data:function(){return{model:{},tempCoupon:{}}},props:["coupon"],methods:{showCouponModal:function(){this.modal.show()},closeCouponModal:function(){this.modal.hide()}},watch:{coupon:function(){this.tempCoupon=this.coupon}},mounted:function(){this.modal=new V.a(this.$refs.CouponModal)}};E.render=N;var I=E,S=o("ec05"),B={data:function(){return{coupons:{},tempCoupon:{},pagination:{},isLoading:"",is_New:!1}},components:{CouponModal:I,DelModal:S["a"]},methods:{openModal:function(t,e){t?this.tempCoupon={}:(e.due_date=this.$filters.date(e.due_date),this.tempCoupon=Object(b["a"])({},e));var o=this.$refs.couponModal;o.showCouponModal()},openDelCouponModal:function(t){this.tempCoupon=Object(b["a"])({},t);var e=this.$refs.delModal;e.showDeleteModal()},delCoupon:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io/","api/").concat("tim-api","/admin/order/").concat(this.tempCoupon.id);this.isLoading=!0,this.$http.delete(e).then((function(e){if(t.$pushMessageState(e,"優惠卷刪除"),e.data.success){var o=t.$refs.delModal;o.hideDeleteModal(),t.getCoupon()}}))},getCoupon:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io/","api/").concat("tim-api","/admin/coupons/?page=").concat(e);this.$http.get(o).then((function(e){t.coupons=e.data.coupons,t.pagination=e.data.pagination,t.isLoading=!1}))},updateCoupon:function(t){var e=this;this.isLoading=!0,this.tempCoupon=t,this.convertToUnixTimestamp();var o=this.$refs.couponModal,n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("tim-api","/admin/coupon"),c="post";this.is_New||(n="".concat("https://vue3-course-api.hexschool.io/","api/").concat("tim-api","/admin/coupon/").concat(t.id),c="put"),this.$http[c](n,{data:this.tempCoupon}).then((function(t){e.$pushMessageState(t,"優惠卷更新"),t.data.success&&(o.closeCouponModal(),e.isLoading=!1,e.getCoupon())}))},convertToUnixTimestamp:function(){var t=+new Date(this.tempCoupon.due_date).getTime(),e=Math.floor(t/1e3);this.tempCoupon.due_date=e},openCouponDeleteModal:function(t){this.tempCoupon=t;var e=this.$refs.couponDeleteModal;e.showCouponDeleteModal()}},created:function(){this.getCoupon()}};B.render=p;e["default"]=B}}]);
//# sourceMappingURL=chunk-2d225da8.76b59ca0.js.map